<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><title>3.2&nbsp;DIY Floating Point Addition</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="scribble-style.css" title="default"/><link rel="stylesheet" type="text/css" href="course.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Computer Architecture (Fall 2015)</a></td></tr></table></div><div class="tocviewsublisttop" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="index.html#%28part._.Introduction%29" class="tocviewlink" data-pltdoc="x">Introduction</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="index.html#%28part._.Lectures%29" class="tocviewlink" data-pltdoc="x">Lectures</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="index.html#%28part._assignments%29" class="tocviewselflink" data-pltdoc="x">Assignments</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="index.html#%28part._turnin%29" class="tocviewlink" data-pltdoc="x">Turn-<wbr></wbr>In and Grading</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="index.html#%28part._.Help%29" class="tocviewlink" data-pltdoc="x">Help</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="index.html#%28part._.Readings%29" class="tocviewlink" data-pltdoc="x">Readings</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="index.html#%28part._software%29" class="tocviewlink" data-pltdoc="x">Software</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="index.html#%28part._.Fine_.Print%29" class="tocviewlink" data-pltdoc="x">Fine Print</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9660;</a></td><td>3&nbsp;</td><td><a href="index.html#%28part._assignments%29" class="tocviewlink" data-pltdoc="x">Assignments</a></td></tr></table><div class="tocviewsublistbottom" style="display: block;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">3.1&nbsp;</td><td><a href="a1.html" class="tocviewlink" data-pltdoc="x">Floating Point Representation</a></td></tr><tr><td align="right">3.2&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">DIY Floating Point Addition</a></td></tr><tr><td align="right">3.3&nbsp;</td><td><a href="a3.html" class="tocviewlink" data-pltdoc="x">MIC-<wbr></wbr>1 Fibonacci</a></td></tr><tr><td align="right">3.4&nbsp;</td><td><a href="exam1.html" class="tocviewlink" data-pltdoc="x">Exam 1</a></td></tr><tr><td align="right">3.5&nbsp;</td><td><a href="a4.html" class="tocviewlink" data-pltdoc="x">MIC-<wbr></wbr>1 Microcode Extension</a></td></tr><tr><td align="right">3.6&nbsp;</td><td><a href="a5.html" class="tocviewlink" data-pltdoc="x">MIC-<wbr></wbr>1 Calculator</a></td></tr><tr><td align="right">3.7&nbsp;</td><td><a href="exam2.html" class="tocviewlink" data-pltdoc="x">Exam 2</a></td></tr><tr><td align="right">3.8&nbsp;</td><td><a href="a6.html" class="tocviewlink" data-pltdoc="x">MIC-<wbr></wbr>1 Linker</a></td></tr><tr><td align="right">3.9&nbsp;</td><td><a href="a7.html" class="tocviewlink" data-pltdoc="x">UNIX Processes</a></td></tr><tr><td align="right">3.10&nbsp;</td><td><a href="e1.html" class="tocviewlink" data-pltdoc="x">Cache Simulator</a></td></tr><tr><td align="right">3.11&nbsp;</td><td><a href="final.html" class="tocviewlink" data-pltdoc="x">Final</a></td></tr></table></div></div></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="a1.html" title="backward to &quot;3.1 Floating Point Representation&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html#%28part._assignments%29" title="up to &quot;3 Assignments&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="a3.html" title="forward to &quot;3.3 MIC-1 Fibonacci&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h4>3.2<tt>&nbsp;</tt><a name="(part._a2)"></a>DIY Floating Point Addition</h4><p>In C, write a program that reads pairs of 32-bit floating point
numbers from standard input and adds them together using only C&rsquo;s
integer operations, then displays the result.</p><p>You only need to deal with positive floating point numbers with no
more than six (6) significant digits and between <span class="RktInBG"><span class="hspace"></span><span class="RktIn">+10^-37</span><span class="hspace"></span></span> and
<span class="RktInBG"><span class="hspace"></span><span class="RktIn">+10^37</span><span class="hspace"></span></span>.</p><p>Your program should expect any number of pairs of numbers. Each
element of the pair should be delimited by a space
character (<span class="RktInBG"><span class="hspace">&nbsp;</span></span>) and each pair should be delimited by newline
characters (<span class="RktInBG"><span class="hspace"></span><span class="RktIn">\n</span><span class="hspace"></span></span>). The addition of each pair should be printed
one-by-one. When the input to the program ends, the program should
exit without errors.</p><p>The representation must be displayed in the following format, as
demonstrated with the input <span class="RktInBG"><span class="hspace"></span><span class="RktIn">34.5 1.250</span><span class="hspace"></span></span>:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">Float 1: 34.500000</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">bits: 0 1000 0100 000 1010 0000 0000 0000 0000</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">Float 2: 1.250000</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">bits: 0 0111 1111 010 0000 0000 0000 0000 0000</span></p></td></tr><tr><td><p><span class="stt">Hardware: 35.750000</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">bits: 0 1000 0100 000 1111 0000 0000 0000 0000</span></p></td></tr><tr><td><p><span class="stt">Emulated: 35.750000</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">bits: 0 1000 0100 000 1111 0000 0000 0000 0000</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr></table></p><p>The program should have no other output.</p><p><div class="SIntrapara">You must turn in
</div><div class="SIntrapara"><ul><li><p>A <span class="RktSym">README</span><span class="RktMeta"></span> file that contains a short write-up of your
project. It should discuss the approach you took to solving the
problem, it should discuss any problems or issues that still remain,
it should discuss any interesting things that you learned in the
course of the project. Finally, it should provide the grade you
believe the project deserves with a detailed explanation of why. This
explanation should almost certainly focus on why you believe the
program is correct.</p><p>This file must be in plain-text. If you need formatting, use
Markdown. It must be limited to 80 characters wide, unless you are
quoting program output.</p></li><li><p>Your source code, named <span class="RktSym">a2.c</span><span class="RktMeta"></span>.</p></li><li><p>A test input file, named <span class="RktSym">test.in</span><span class="RktMeta"></span>, that contains example
input. It must contain at least ten (10) pairs. In addition to
four (4) pairs of your choosing, it must contain these pairs:</p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">34.5 1.25</span></p></td></tr><tr><td><p><span class="stt">2.75e3 256.0</span></p></td></tr><tr><td><p><span class="stt">1.4e-3 13.0</span></p></td></tr><tr><td><p><span class="stt">7.491 4.617e20</span></p></td></tr><tr><td><p><span class="stt">9643.0 1.237e-2</span></p></td></tr><tr><td><p><span class="stt">25e37 15e37</span></p></td></tr></table></li><li><p>A test output file, named <span class="RktSym">test.out</span><span class="RktMeta"></span>, that contains the
expected output for the test data.</p></li><li><p>A <span class="RktSym">Makefile</span><span class="RktMeta"></span> that first builds the program and then tests
it by running it with <span class="RktSym">test.in</span><span class="RktMeta"></span> as the input and compares the
actual output to <span class="RktSym">test.out</span><span class="RktMeta"></span>.</p></li></ul></div></p><p>This assignment will be graded based on its correctness and your
ability to articulate why it is correct.</p><p>Here&rsquo;s some advice about how to do this: First, copy the mantissa
values and expose the hidden bits so you have a 24-bit value rather
than a 23-bit value. Second, shift the mantissa of the smaller value
while decrementing the exponent until the exponents are equal. Third,
add the mantissa values. Fourth, construct a new emulated float with
the added mantissa and the common exponent. These first four steps are
just a matter of C bit-twiddling. The hard part will come from dealing
properly with removing the hidden bit, dealing with carrying during
addition, and ensuring that you shift values correctly.</p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="a1.html" title="backward to &quot;3.1 Floating Point Representation&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html#%28part._assignments%29" title="up to &quot;3 Assignments&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="a3.html" title="forward to &quot;3.3 MIC-1 Fibonacci&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>