<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8" /><title>3.9&nbsp;Garbage Collectors</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default" /><link rel="stylesheet" type="text/css" href="racket.css" title="default" /><link rel="stylesheet" type="text/css" href="scribble-style.css" title="default" /><link rel="stylesheet" type="text/css" href="course.css" title="default" /><script type="text/javascript" src="scribble-common.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist" style="margin-bottom: 1em;"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Programming Language Design (Fall 2012)</a></td></tr></table></div><div class="tocviewsublisttop" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="index.html#(part._.Introduction)" class="tocviewlink" data-pltdoc="x">Introduction</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="index.html#(part._.Lectures)" class="tocviewlink" data-pltdoc="x">Lectures</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="index.html#(part._assignments)" class="tocviewselflink" data-pltdoc="x">Assignments</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="index.html#(part._turnin)" class="tocviewlink" data-pltdoc="x">Turn-<wbr></wbr>In and Grading</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="index.html#(part._.Help)" class="tocviewlink" data-pltdoc="x">Help</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="index.html#(part._.Readings)" class="tocviewlink" data-pltdoc="x">Readings</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="index.html#(part._software)" class="tocviewlink" data-pltdoc="x">Software</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9660;</a></td><td>3&nbsp;</td><td><a href="index.html#(part._assignments)" class="tocviewlink" data-pltdoc="x">Assignments</a></td></tr></table><div class="tocviewsublist" style="display: block;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">3.1&nbsp;</td><td><a href="basic.html" class="tocviewlink" data-pltdoc="x">Basic Racket</a></td></tr><tr><td align="right">3.2&nbsp;</td><td><a href="lists.html" class="tocviewlink" data-pltdoc="x">Lists and Trees</a></td></tr><tr><td align="right">3.3&nbsp;</td><td><a href="hof.html" class="tocviewlink" data-pltdoc="x">Higher-<wbr></wbr>order Functions</a></td></tr><tr><td align="right">3.4&nbsp;</td><td><a href="rinterp.html" class="tocviewlink" data-pltdoc="x">Rudimentary Interpreter</a></td></tr><tr><td align="right">3.5&nbsp;</td><td><a href="xinterp.html" class="tocviewlink" data-pltdoc="x">Extended Interpreter</a></td></tr><tr><td align="right">3.6&nbsp;</td><td><a href="lazy.html" class="tocviewlink" data-pltdoc="x">Laziness and Infinite Data</a></td></tr><tr><td align="right">3.7&nbsp;</td><td><a href="rawweb.html" class="tocviewlink" data-pltdoc="x">Raw Web Programming</a></td></tr><tr><td align="right">3.8&nbsp;</td><td><a href="pltweb.html" class="tocviewlink" data-pltdoc="x">Racket Web Programming</a></td></tr><tr><td align="right">3.9&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Garbage Collectors</a></td></tr><tr><td align="right">3.10&nbsp;</td><td><a href="typec.html" class="tocviewlink" data-pltdoc="x">Type Checker</a></td></tr><tr><td align="right">3.11&nbsp;</td><td><a href="typei.html" class="tocviewlink" data-pltdoc="x">Type Inferrer</a></td></tr><tr><td align="right">3.12&nbsp;</td><td><a href="prolog.html" class="tocviewlink" data-pltdoc="x">Prolog</a></td></tr><tr><td align="right">3.13&nbsp;</td><td><a href="wlang1.html" class="tocviewlink" data-pltdoc="x">Language Analysis the First</a></td></tr><tr><td align="right">3.14&nbsp;</td><td><a href="wlazy.html" class="tocviewlink" data-pltdoc="x">Analysis:<span class="mywbr"> </span> Laziness</a></td></tr><tr><td align="right">3.15&nbsp;</td><td><a href="wcont.html" class="tocviewlink" data-pltdoc="x">Analysis:<span class="mywbr"> </span> Continuations</a></td></tr><tr><td align="right">3.16&nbsp;</td><td><a href="wlang2.html" class="tocviewlink" data-pltdoc="x">Language Analysis the Second</a></td></tr><tr><td align="right">3.17&nbsp;</td><td><a href="wgc.html" class="tocviewlink" data-pltdoc="x">Analysis:<span class="mywbr"> </span> Garbage Collection</a></td></tr><tr><td align="right">3.18&nbsp;</td><td><a href="wtype.html" class="tocviewlink" data-pltdoc="x">Analysis:<span class="mywbr"> </span> Type Systems</a></td></tr><tr><td align="right">3.19&nbsp;</td><td><a href="final.html" class="tocviewlink" data-pltdoc="x">Final</a></td></tr><tr><td align="right">3.20&nbsp;</td><td><a href="survey.html" class="tocviewlink" data-pltdoc="x">Survey</a></td></tr><tr><td align="right">3.21&nbsp;</td><td><a href="jay-eval1.html" class="tocviewlink" data-pltdoc="x">Unofficial Course Evaluation the First</a></td></tr><tr><td align="right">3.22&nbsp;</td><td><a href="jay-eval2.html" class="tocviewlink" data-pltdoc="x">Unofficial Course Evaluation the Second</a></td></tr><tr><td align="right">3.23&nbsp;</td><td><a href="byu-eval.html" class="tocviewlink" data-pltdoc="x">Official Course Evaluation</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_2&quot;);">&#9658;</a></td><td>3.9&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Garbage Collectors</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_2"><table cellspacing="0" cellpadding="0"><tr><td align="right">3.9.1&nbsp;</td><td><a href="#(part._.Writing_your_.Garbage_.Collectors)" class="tocviewlink" data-pltdoc="x">Writing your Garbage Collectors</a></td></tr><tr><td align="right">3.9.2&nbsp;</td><td><a href="#(part._.Testing_your_.Garbage_.Collectors)" class="tocviewlink" data-pltdoc="x">Testing your Garbage Collectors</a></td></tr><tr><td align="right">3.9.3&nbsp;</td><td><a href="#(part._.Sample_.Code)" class="tocviewlink" data-pltdoc="x">Sample Code</a></td></tr><tr><td align="right">3.9.4&nbsp;</td><td><a href="#(part._.Notes)" class="tocviewlink" data-pltdoc="x">Notes</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">3.9.1<tt>&nbsp;</tt></span><a href="#(part._.Writing_your_.Garbage_.Collectors)" class="tocsubseclink" data-pltdoc="x">Writing your Garbage Collectors</a></td></tr><tr><td><span class="tocsublinknumber">3.9.1.1<tt>&nbsp;</tt></span><a href="#(part._.Required_.Functions)" class="tocsubseclink" data-pltdoc="x">Required Functions</a></td></tr><tr><td><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._init-allocator))" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">init-<wbr></wbr>allocator</span></span></a></td></tr><tr><td><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3aalloc-flat))" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">gc:<span class="mywbr"> </span>alloc-<wbr></wbr>flat</span></span></a></td></tr><tr><td><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3acons))" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">gc:<span class="mywbr"> </span>cons</span></span></a></td></tr><tr><td><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3acons~3f))" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">gc:<span class="mywbr"> </span>cons?</span></span></a></td></tr><tr><td><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3afirst))" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">gc:<span class="mywbr"> </span>first</span></span></a></td></tr><tr><td><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3aset-first!))" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">gc:<span class="mywbr"> </span>set-<wbr></wbr>first!</span></span></a></td></tr><tr><td><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3arest))" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">gc:<span class="mywbr"> </span>rest</span></span></a></td></tr><tr><td><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3aset-rest!))" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">gc:<span class="mywbr"> </span>set-<wbr></wbr>rest!</span></span></a></td></tr><tr><td><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3aflat~3f))" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">gc:<span class="mywbr"> </span>flat?</span></span></a></td></tr><tr><td><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3aderef))" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">gc:<span class="mywbr"> </span>deref</span></span></a></td></tr><tr><td><span class="tocsublinknumber">3.9.1.2<tt>&nbsp;</tt></span><a href="#(part._.Provided_.Functions)" class="tocsubseclink" data-pltdoc="x">Provided Functions</a></td></tr><tr><td><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-value~3f))" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">heap-<wbr></wbr>value?</span></span></a></td></tr><tr><td><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._location~3f))" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">location?</span></span></a></td></tr><tr><td><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-size))" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">heap-<wbr></wbr>size</span></span></a></td></tr><tr><td><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-set!))" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">heap-<wbr></wbr>set!</span></span></a></td></tr><tr><td><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-ref))" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">heap-<wbr></wbr>ref</span></span></a></td></tr><tr><td><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._root~3f))" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">root?</span></span></a></td></tr><tr><td><a href="#(form._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._get-root-set))" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">get-<wbr></wbr>root-<wbr></wbr>set</span></span></a></td></tr><tr><td><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._read-root))" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">read-<wbr></wbr>root</span></span></a></td></tr><tr><td><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._set-root!))" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">set-<wbr></wbr>root!</span></span></a></td></tr><tr><td><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._procedure-roots))" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">procedure-<wbr></wbr>roots</span></span></a></td></tr><tr><td><a href="#(form._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._allocator-setup))" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">allocator-<wbr></wbr>setup</span></span></a></td></tr><tr><td><span class="tocsublinknumber">3.9.2<tt>&nbsp;</tt></span><a href="#(part._.Testing_your_.Garbage_.Collectors)" class="tocsubseclink" data-pltdoc="x">Testing your Garbage Collectors</a></td></tr><tr><td><span class="tocsublinknumber">3.9.3<tt>&nbsp;</tt></span><a href="#(part._.Sample_.Code)" class="tocsubseclink" data-pltdoc="x">Sample Code</a></td></tr><tr><td><span class="tocsublinknumber">3.9.3.1<tt>&nbsp;</tt></span><a href="#(part._.Trivial_.Collector)" class="tocsubseclink" data-pltdoc="x">Trivial Collector</a></td></tr><tr><td><span class="tocsublinknumber">3.9.4<tt>&nbsp;</tt></span><a href="#(part._.Notes)" class="tocsubseclink" data-pltdoc="x">Notes</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft">&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="pltweb.html" title="backward to &quot;3.8 Racket Web Programming&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html#(part._assignments)" title="up to &quot;3 Assignments&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="typec.html" title="forward to &quot;3.10 Type Checker&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h4>3.9<tt>&nbsp;</tt><a name="(part._gc)"></a>Garbage Collectors</h4><p>In this assignment, you will implement two garbage collectors: mark &amp; sweep, and stop &amp; copy. As we have seen, garbage
collection involves starting from a root set of references, which reside in local variables and stack frames, and searching
for reachable values on the heap.</p><h5>3.9.1<tt>&nbsp;</tt><a name="(part._.Writing_your_.Garbage_.Collectors)"></a>Writing your Garbage Collectors</h5><blockquote class="SubFlow"><p><div class="SIntrapara">You must complete this assignment using a specific language.
Choose <span style="font-family: sans-serif; font-size: 80%; font-weight: bold">Determine language from source</span> in the DrRacket menu, then
write
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><a href="http://docs.racket-lang.org/guide/Module_Syntax.html#(part._hash-lang)" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a><span class="hspace">&nbsp;</span><a href="http://docs.racket-lang.org/plai/collector.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">plai/collector</span></a></p></blockquote></div><div class="SIntrapara">as the <span style="font-style: italic">first line</span> of your program, overwritting the default <a href="http://docs.racket-lang.org/guide/Module_Syntax.html#(part._hash-lang)" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a> at the top of the file.</div></p></blockquote><p>This language defines an interface to a program&rsquo;s stack and heap that you will use to implement garbage collection.</p><h5>3.9.1.1<tt>&nbsp;</tt><a name="(part._.Required_.Functions)"></a>Required Functions</h5><p>Your garbage collectors must implement the following functions:</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._init-allocator))"></a><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._init-allocator))" class="RktValLink" data-pltdoc="x">init-allocator</a></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/void.html#(def._((quote._~23~25kernel)._void))" class="RktValLink" data-pltdoc="x">void</a></span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">The mutator implicitly calls this function after initializing the heap and before calling any allocation routines.
It is essentially a callback into the allocator indicating that the heap is ready.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3aalloc-flat))"></a><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3aalloc-flat))" class="RktValLink" data-pltdoc="x">gc:alloc-flat</a></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._location~3f))" class="RktValLink" data-pltdoc="x">location?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-value~3f))" class="RktValLink" data-pltdoc="x">heap-value?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Allocates space for a flat value and returns the base address of the allocated block.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3acons))"></a><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3acons))" class="RktValLink" data-pltdoc="x">gc:cons</a></span><span class="hspace">&nbsp;</span><span class="RktVar">first-addr</span><span class="hspace">&nbsp;</span><span class="RktVar">rest-addr</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._location~3f))" class="RktValLink" data-pltdoc="x">location?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">first-addr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._location~3f))" class="RktValLink" data-pltdoc="x">location?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">rest-addr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._location~3f))" class="RktValLink" data-pltdoc="x">location?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the address of a new cons cell with the given field addresses; the field addresses are presumed to be already allocated.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3acons~3f))"></a><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3acons~3f))" class="RktValLink" data-pltdoc="x">gc:cons?</a></span><span class="hspace">&nbsp;</span><span class="RktVar">addr</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#(def._((quote._~23~25kernel)._boolean~3f))" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">addr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._location~3f))" class="RktValLink" data-pltdoc="x">location?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns a boolean that indicates whether the given address refers to a cons cell.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3afirst))"></a><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3afirst))" class="RktValLink" data-pltdoc="x">gc:first</a></span><span class="hspace">&nbsp;</span><span class="RktVar">cons-addr</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._location~3f))" class="RktValLink" data-pltdoc="x">location?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">cons-addr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._location~3f))" class="RktValLink" data-pltdoc="x">location?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the address of the first part of a cons.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3aset-first!))"></a><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3aset-first!))" class="RktValLink" data-pltdoc="x">gc:set-first!</a></span><span class="hspace">&nbsp;</span><span class="RktVar">cons-addr</span><span class="hspace">&nbsp;</span><span class="RktVar">first-addr</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/void.html#(def._((quote._~23~25kernel)._void))" class="RktValLink" data-pltdoc="x">void</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">cons-addr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._location~3f))" class="RktValLink" data-pltdoc="x">location?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">first-addr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._location~3f))" class="RktValLink" data-pltdoc="x">location?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Sets the address of the first part of a cons.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3arest))"></a><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3arest))" class="RktValLink" data-pltdoc="x">gc:rest</a></span><span class="hspace">&nbsp;</span><span class="RktVar">cons-addr</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._location~3f))" class="RktValLink" data-pltdoc="x">location?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">cons-addr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._location~3f))" class="RktValLink" data-pltdoc="x">location?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the address of the rest part of a cons.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3aset-rest!))"></a><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3aset-rest!))" class="RktValLink" data-pltdoc="x">gc:set-rest!</a></span><span class="hspace">&nbsp;</span><span class="RktVar">cons-addr</span><span class="hspace">&nbsp;</span><span class="RktVar">rest-addr</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/void.html#(def._((quote._~23~25kernel)._void))" class="RktValLink" data-pltdoc="x">void</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">cons-addr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._location~3f))" class="RktValLink" data-pltdoc="x">location?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">rest-addr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._location~3f))" class="RktValLink" data-pltdoc="x">location?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Sets the address of the rest part of a cons.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3aflat~3f))"></a><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3aflat~3f))" class="RktValLink" data-pltdoc="x">gc:flat?</a></span><span class="hspace">&nbsp;</span><span class="RktVar">addr</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#(def._((quote._~23~25kernel)._boolean~3f))" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">addr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._location~3f))" class="RktValLink" data-pltdoc="x">location?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns a boolean that indicates whether the given address refers to an atomic value.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3aderef))"></a><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3aderef))" class="RktValLink" data-pltdoc="x">gc:deref</a></span><span class="hspace">&nbsp;</span><span class="RktVar">addr</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-value~3f))" class="RktValLink" data-pltdoc="x">heap-value?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">addr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._location~3f))" class="RktValLink" data-pltdoc="x">location?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the atomic value stored at the given address.</div></p><h5>3.9.1.2<tt>&nbsp;</tt><a name="(part._.Provided_.Functions)"></a>Provided Functions</h5><p>To help you write these functions, the <span style="font-family: sans-serif; font-size: 80%; font-weight: bold">GC Collector Racket</span> language defines an interface for the heap and the roots:</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-value~3f))"></a><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-value~3f))" class="RktValLink" data-pltdoc="x">heap-value?</a></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#(def._((quote._~23~25kernel)._boolean~3f))" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#(def._((lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt)._any%2Fc))" class="RktValLink" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Equivalent to </div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket%2Fprivate%2Fletstx-scheme..rkt)._or))" class="RktStxLink" data-pltdoc="x">or</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#(def._((quote._~23~25kernel)._boolean~3f))" class="RktValLink" data-pltdoc="x">boolean?</a></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" data-pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/procedures.html#(def._((quote._~23~25kernel)._procedure~3f))" class="RktValLink" data-pltdoc="x">procedure?</a></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/symbols.html#(def._((quote._~23~25kernel)._symbol~3f))" class="RktValLink" data-pltdoc="x">symbol?</a></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#(def._((lib._racket%2Flist..rkt)._empty~3f))" class="RktValLink" data-pltdoc="x">empty?</a></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._location~3f))"></a><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._location~3f))" class="RktValLink" data-pltdoc="x">location?</a></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#(def._((quote._~23~25kernel)._boolean~3f))" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#(def._((lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt)._any%2Fc))" class="RktValLink" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">A location is an integer between <span class="RktVal">0</span> and <span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-size))" class="RktValLink" data-pltdoc="x">heap-size</a></span><span class="RktPn">)</span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span> inclusive.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-size))"></a><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-size))" class="RktValLink" data-pltdoc="x">heap-size</a></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" data-pltdoc="x">number?</a></span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Returns the size of the heap.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-set!))"></a><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-set!))" class="RktValLink" data-pltdoc="x">heap-set!</a></span><span class="hspace">&nbsp;</span><span class="RktVar">addr</span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/void.html#(def._((quote._~23~25kernel)._void))" class="RktValLink" data-pltdoc="x">void</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">addr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._location~3f))" class="RktValLink" data-pltdoc="x">location?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-value~3f))" class="RktValLink" data-pltdoc="x">heap-value?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Stores a value at the specified address.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-ref))"></a><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-ref))" class="RktValLink" data-pltdoc="x">heap-ref</a></span><span class="hspace">&nbsp;</span><span class="RktVar">addr</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-value~3f))" class="RktValLink" data-pltdoc="x">heap-value?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">addr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._location~3f))" class="RktValLink" data-pltdoc="x">location?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the value at the specified address.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._root~3f))"></a><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._root~3f))" class="RktValLink" data-pltdoc="x">root?</a></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#(def._((quote._~23~25kernel)._boolean~3f))" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#(def._((lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt)._any%2Fc))" class="RktValLink" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Determines if <span class="RktVar">v</span> is a root.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._get-root-set))"></a><span class="RktSym"><a href="#(form._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._get-root-set))" class="RktStxLink" data-pltdoc="x">get-root-set</a></span><span class="hspace">&nbsp;</span><span class="RktVar">root-identifier</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">root-identifier</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stxops.html#(def._((lib._racket%2Fprivate%2Fstx..rkt)._identifier~3f))" class="RktValLink" data-pltdoc="x">identifier?</a></span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Returns the roots of the collection, including local roots created for each <span class="RktVar">root-identifier</span>.</div></p><p><span style="font-weight: bold">Note:</span> Sometimes you have to fake roots in case a live object is only reachable from arguments passed to a collector function. For example, you should pass the first and rest addresses to <span class="RktSym"><a href="#(form._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._get-root-set))" class="RktStxLink" data-pltdoc="x">get-root-set</a></span> in your implementation of <span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3acons))" class="RktValLink" data-pltdoc="x">gc:cons</a></span>. (This is not the only example!)</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._read-root))"></a><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._read-root))" class="RktValLink" data-pltdoc="x">read-root</a></span><span class="hspace">&nbsp;</span><span class="RktVar">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._location~3f))" class="RktValLink" data-pltdoc="x">location?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">r</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._root~3f))" class="RktValLink" data-pltdoc="x">root?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the address the root references.
</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._set-root!))"></a><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._set-root!))" class="RktValLink" data-pltdoc="x">set-root!</a></span><span class="hspace">&nbsp;</span><span class="RktVar">r</span><span class="hspace">&nbsp;</span><span class="RktVar">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/void.html#(def._((quote._~23~25kernel)._void))" class="RktValLink" data-pltdoc="x">void</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">r</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._root~3f))" class="RktValLink" data-pltdoc="x">root?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">a</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._location~3f))" class="RktValLink" data-pltdoc="x">location?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Updates the root to reference the specified address.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._procedure-roots))"></a><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._procedure-roots))" class="RktValLink" data-pltdoc="x">procedure-roots</a></span><span class="hspace">&nbsp;</span><span class="RktVar">proc</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#(def._((lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt)._listof))" class="RktValLink" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._root~3f))" class="RktValLink" data-pltdoc="x">root?</a></span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">proc</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/procedures.html#(def._((quote._~23~25kernel)._procedure~3f))" class="RktValLink" data-pltdoc="x">procedure?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Given a closure stored on the heap, returns a list of the roots reachable from the closure&#8217;s environment. If <span class="RktVar">proc</span> is not reachable, the empty list is returned.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._allocator-setup))"></a><span class="RktSym"><a href="#(form._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._allocator-setup))" class="RktStxLink" data-pltdoc="x">allocator-setup</a></span><span class="hspace">&nbsp;</span><span class="RktVar">collector-file</span><span class="hspace">&nbsp;</span><span class="RktVar">heap-size</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><blockquote class="SubFlow"><table cellspacing="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">collector-file</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="http://docs.racket-lang.org/reference/strings.html#(def._((quote._~23~25kernel)._string~3f))" class="RktValLink" data-pltdoc="x">string?</a></span></td></tr></table><table cellspacing="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">heap-size</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" data-pltdoc="x">number?</a></span></td></tr></table></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Uses <span class="RktVar">collector-file</span> for the collector with a heap initialized to <span class="RktVar">heap-size</span>.</div></p><h5>3.9.2<tt>&nbsp;</tt><a name="(part._.Testing_your_.Garbage_.Collectors)"></a>Testing your Garbage Collectors</h5><blockquote class="SubFlow"><p><div class="SIntrapara">You must complete this assignment using a specific language.
Choose <span style="font-family: sans-serif; font-size: 80%; font-weight: bold">Determine language from source</span> in the DrRacket menu, then
write
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><a href="http://docs.racket-lang.org/guide/Module_Syntax.html#(part._hash-lang)" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a><span class="hspace">&nbsp;</span><a href="http://docs.racket-lang.org/plai/mutator.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">plai/mutator</span></a></p></blockquote></div><div class="SIntrapara">as the <span style="font-style: italic">first line</span> of your program, overwritting the default <a href="http://docs.racket-lang.org/guide/Module_Syntax.html#(part._hash-lang)" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a> at the top of the file.</div></p></blockquote><p><div class="SIntrapara">This language is a subset of Racket that uses a garbage collector that you specify. The first line of a test program must be:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="#(form._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._allocator-setup))" class="RktStxLink" data-pltdoc="x">allocator-setup</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"collector.rkt"</span><span class="hspace">&nbsp;</span><span class="RktVar">heap-size</span><span class="RktPn">)</span></p></blockquote></div><div class="SIntrapara">where <span class="RktVal">"collector.rkt"</span> must be the name of your collector&rsquo;s file. <span class="RktVar">heap-size</span> is the size of the heap your collector will use.</div></p><p>The remainder of the program is in a subset of Racket with numbers, symbols, lists, etc.
The primitives of the language map directly to the procedures you define in your garbage collector.</p><h5>3.9.3<tt>&nbsp;</tt><a name="(part._.Sample_.Code)"></a>Sample Code</h5><p>To get you started, we&rsquo;ve provided a trivial collector that signals an error when the heap fills up.</p><h5>3.9.3.1<tt>&nbsp;</tt><a name="(part._.Trivial_.Collector)"></a>Trivial Collector</h5><p><span class="stt">"collector.rkt"</span>:</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><a href="http://docs.racket-lang.org/guide/Module_Syntax.html#(part._hash-lang)" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a><span class="hspace">&nbsp;</span><a href="http://docs.racket-lang.org/plai/collector.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">plai/collector</span></a></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket%2Fprivate%2Fbase..rkt)._define))" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">heap-ptr</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">uninitialized-heap-ptr</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket%2Fprivate%2Fbase..rkt)._define))" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._init-allocator))" class="RktValLink" data-pltdoc="x">init-allocator</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/set_.html#(form._((quote._~23~25kernel)._set!))" class="RktStxLink" data-pltdoc="x">set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">heap-ptr</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket%2Fprivate%2Fbase..rkt)._define))" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3aalloc-flat))" class="RktValLink" data-pltdoc="x">gc:alloc-flat</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/begin.html#(form._((quote._~23~25kernel)._begin))" class="RktStxLink" data-pltdoc="x">begin</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/when_unless.html#(form._((lib._racket%2Fprivate%2Fletstx-scheme..rkt)._when))" class="RktStxLink" data-pltdoc="x">when</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._~3e))" class="RktValLink" data-pltdoc="x">&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._%2B))" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">heap-ptr</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-size))" class="RktValLink" data-pltdoc="x">heap-size</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/exns.html#(def._((quote._~23~25kernel)._error))" class="RktValLink" data-pltdoc="x">error</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">gc:alloc-flat</span><span class="hspace">&nbsp;</span><span class="RktVal">"out of memory"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-set!))" class="RktValLink" data-pltdoc="x">heap-set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">heap-ptr</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">prim</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-set!))" class="RktValLink" data-pltdoc="x">heap-set!</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._%2B))" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktSym">heap-ptr</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/set_.html#(form._((quote._~23~25kernel)._set!))" class="RktStxLink" data-pltdoc="x">set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">heap-ptr</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._%2B))" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktSym">heap-ptr</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">heap-ptr</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket%2Fprivate%2Fbase..rkt)._define))" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3acons))" class="RktValLink" data-pltdoc="x">gc:cons</a></span><span class="hspace">&nbsp;</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/begin.html#(form._((quote._~23~25kernel)._begin))" class="RktStxLink" data-pltdoc="x">begin</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/when_unless.html#(form._((lib._racket%2Fprivate%2Fletstx-scheme..rkt)._when))" class="RktStxLink" data-pltdoc="x">when</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._~3e))" class="RktValLink" data-pltdoc="x">&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._%2B))" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">heap-ptr</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-size))" class="RktValLink" data-pltdoc="x">heap-size</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/exns.html#(def._((quote._~23~25kernel)._error))" class="RktValLink" data-pltdoc="x">error</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">gc:cons</span><span class="hspace">&nbsp;</span><span class="RktVal">"out of memory"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-set!))" class="RktValLink" data-pltdoc="x">heap-set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">heap-ptr</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">cons</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-set!))" class="RktValLink" data-pltdoc="x">heap-set!</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._%2B))" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktSym">heap-ptr</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-set!))" class="RktValLink" data-pltdoc="x">heap-set!</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._%2B))" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktSym">heap-ptr</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/set_.html#(form._((quote._~23~25kernel)._set!))" class="RktStxLink" data-pltdoc="x">set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">heap-ptr</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._%2B))" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktSym">heap-ptr</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">heap-ptr</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket%2Fprivate%2Fbase..rkt)._define))" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3acons~3f))" class="RktValLink" data-pltdoc="x">gc:cons?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#(def._((quote._~23~25kernel)._eq~3f))" class="RktValLink" data-pltdoc="x">eq?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-ref))" class="RktValLink" data-pltdoc="x">heap-ref</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">cons</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket%2Fprivate%2Fbase..rkt)._define))" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3afirst))" class="RktValLink" data-pltdoc="x">gc:first</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-ref))" class="RktValLink" data-pltdoc="x">heap-ref</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._%2B))" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket%2Fprivate%2Fbase..rkt)._define))" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3arest))" class="RktValLink" data-pltdoc="x">gc:rest</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-ref))" class="RktValLink" data-pltdoc="x">heap-ref</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._%2B))" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket%2Fprivate%2Fbase..rkt)._define))" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3aset-first!))" class="RktValLink" data-pltdoc="x">gc:set-first!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#(form._((quote._~23~25kernel)._if))" class="RktStxLink" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3acons~3f))" class="RktValLink" data-pltdoc="x">gc:cons?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-set!))" class="RktValLink" data-pltdoc="x">heap-set!</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._%2B))" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/exns.html#(def._((quote._~23~25kernel)._error))" class="RktValLink" data-pltdoc="x">error</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">set-first!</span><span class="hspace">&nbsp;</span><span class="RktVal">"expects address of cons"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket%2Fprivate%2Fbase..rkt)._define))" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3aset-rest!))" class="RktValLink" data-pltdoc="x">gc:set-rest!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-set!))" class="RktValLink" data-pltdoc="x">heap-set!</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._%2B))" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket%2Fprivate%2Fbase..rkt)._define))" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3aflat~3f))" class="RktValLink" data-pltdoc="x">gc:flat?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#(def._((quote._~23~25kernel)._eq~3f))" class="RktValLink" data-pltdoc="x">eq?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-ref))" class="RktValLink" data-pltdoc="x">heap-ref</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">prim</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket%2Fprivate%2Fbase..rkt)._define))" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._gc~3aderef))" class="RktValLink" data-pltdoc="x">gc:deref</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._(/home/jay/.Dev/scm/github..jeapostrophe/work/courses/2012/fall/330/a/gc/gc..rkt._heap-ref))" class="RktValLink" data-pltdoc="x">heap-ref</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._%2B))" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><h5>3.9.4<tt>&nbsp;</tt><a name="(part._.Notes)"></a>Notes</h5><p>You must store bookkeeping data on the heap provided by <span style="font-family: sans-serif; font-size: 80%; font-weight: bold">GC Collector Racket.</span> You may store 2-3 atomic values,
such as addresses into the heap as variables in your garbage collector. We will assume they represent machine registers.
However, all compound data structures must be on the heap.</p><p>In particular, in the mark &amp; sweep collector, you should maintain a free list in the heap. That is, you should not use
any auxiliary data structure; instead, use the available space in the heap to keep track of the free list. You may use
one extra box (&ldquo;register&rdquo;) to point to the start of the free list. You may need to adjust your allocation accordingly
to have enough space to maintain free list pointers!</p><p><div class="SIntrapara">Some final words of advice:
</div><div class="SIntrapara"><ul><li><p>You will want to test your program with small heap sizes, so that the garbage collector runs frequently.</p></li><li><p>You do not need to compact memory in mark-and-sweep.</p></li><li><p>You may find it convenient to use the Racket construct <span class="RktSym"><a href="http://docs.racket-lang.org/reference/set_.html#(form._((quote._~23~25kernel)._set!))" class="RktStxLink" data-pltdoc="x">set!</a></span>, which allows you to mutate a variable without using boxes.
We recommend you use this feature only in one instance: when swapping the semispaces in the stop &amp; copy collector.
This will save you the trouble of unboxing the heap every time you use it.</p></li></ul></div></p><div class="navsetbottom"><span class="navleft">&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="pltweb.html" title="backward to &quot;3.8 Racket Web Programming&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html#(part._assignments)" title="up to &quot;3 Assignments&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="typec.html" title="forward to &quot;3.10 Type Checker&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>