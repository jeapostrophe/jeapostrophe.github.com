<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>2013-09-30: How I wrote my RacketCon 2013 Slideshow</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--><link href="atom.xml" rel="alternate" title="Jay McCarthy" type="application/atom+xml"/><script type="text/javascript">var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30131476-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();</script></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Jay Mc<span class="mywbr"> &nbsp;</span>Carthy</a></td></tr></table></div><div class="tocviewsublisttop" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right"></td><td><a href="cat-categories.html" class="tocviewlink" data-pltdoc="x">Categories</a></td></tr><tr><td align="right"></td><td><a href="archive.html" class="tocviewselflink" data-pltdoc="x">Archive</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;">&bull;</td><td></td><td><a href="archive.html" class="tocviewlink" data-pltdoc="x">Archive</a></td></tr></table></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_2&quot;);">&#9658;</a></td><td></td><td><a href="" class="tocviewselflink" data-pltdoc="x">2013-<wbr></wbr>09-<wbr></wbr>30:<span class="mywbr"> &nbsp;</span> How I wrote my Racket<span class="mywbr"> &nbsp;</span>Con 2013 Slideshow</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_2"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="#%28part._.The_.Movie%29" class="tocviewlink" data-pltdoc="x">The Movie</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#%28part._.The_.Dialogue_.System%29" class="tocviewlink" data-pltdoc="x">The Dialogue System</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="#%28part._.Yo__.It_s_almost_time_to_go_%29" class="tocviewlink" data-pltdoc="x">Yo! It&rsquo;s almost time to go!</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#%28part._.The_.Dialogue_.System%29" class="tocsubseclink" data-pltdoc="x">The Dialogue System</a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#%28part._.Yo__.It_s_almost_time_to_go_%29" class="tocsubseclink" data-pltdoc="x">Yo! It&rsquo;s almost time to go!</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="2013-09-23-dpr-post.html" title="backward to &quot;2013-09-23: Defer, Panic, and Recover in Racket&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="archive.html" title="up to &quot;Archive&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="2013-10-07-fseek-post.html" title="forward to &quot;2013-10-07: Saving State with Dynamic Wind&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h4><a name="(part._post)"></a>2013-09-30: How I wrote my RacketCon 2013 Slideshow</h4><div class="SAuthorListBox"><span class="SAuthorList"><p class="author"><a href="index.html" data-pltdoc="x">Jay McCarthy</a></p></span></div><p><div class="SIntrapara"></div><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>The source for this post is online at <a href="https://github.com/jeapostrophe/jeapostrophe.github.com/tree/source/posts/2013-09-30-pkgtalk.scrbl">2013-09-30-pkgtalk.scrbl</a>.</p></blockquote></blockquote></blockquote></div><div class="SIntrapara"><span style="font-weight: bold">Categories:</span> <a href="cat-categories.html#%28part._.Racket%29" data-pltdoc="x">Racket</a> <a href="cat-categories.html#%28part._.Slideshow%29" data-pltdoc="x">Slideshow</a> <a href="cat-categories.html#%28part._.Languages%29" data-pltdoc="x">Languages</a> <a href="cat-categories.html#%28part._.Insanity%29" data-pltdoc="x">Insanity</a> </div></p><p>At this year&rsquo;s <a href="http://con.racket-lang.org/">RacketCon</a>, I gave
a presentation on the Racket Package System (<a href="http://docs.racket-lang.org/pkg/Functions_for_raco_pkg.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">pkg</span></a>). I
used a story about a young developer learning about the package system
as a way to show how various practical problems are solved by
packages.</p><p>However, this post is not about the content of the talk, but about how
I programmed it using the <a href="http://docs.racket-lang.org/slideshow/index.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">slideshow</span></a> system. You may
want to download and look at
<a href="https://github.com/jeapostrophe/presentations/tree/master/201309-racketcon">the
talk</a> to get a feel for what I&rsquo;ll be explaining. Although there is a
PDF version, it does not contain the movie on the title screen, so
there&rsquo;s a reason to try and run it locally.</p><blockquote class="SCentered"><p>-</p></blockquote><p>The slideshow does two cute things. First, it starts with a movie on
the title screen that is continuously looping. Second, it contains a
dialogue and command-line interaction scripting system to show a long
interaction between the various users. I&rsquo;ll talk about these two
things separately.</p><h5>1<tt>&nbsp;</tt><a name="(part._.The_.Movie)"></a>The Movie</h5><p>In the <a href="http://docs.racket-lang.org/slideshow/index.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">slideshow</span></a>, there is a library for writing
finite animations as functions of time between <span class="RktVal">0</span> and
<span class="RktVal">1</span> called <a href="http://docs.racket-lang.org/slideshow/play.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">slideshow/play</span></a>. It has a fun model
that generates <span class="RktSym">N</span> slides by discretizing and transitioning
between the slides.</p><p>Unfortunately, this means that it can&rsquo;t be used to loop an animation
indefinitely. (At RacketCon, I wanted to put up the title screen
during the break between talks to build anticipation.) However, there
is a function called <span class="RktSym"><a href="http://docs.racket-lang.org/slideshow/Primary_Slide_Functions.html#%28def._%28%28lib._slideshow%2Fbase..rkt%29._interactive%29%29" class="RktValLink" data-pltdoc="x">interactive</a></span> that will embedded a
<a href="http://docs.racket-lang.org/gui/index.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket/gui</span></a> <span class="RktSym"><a href="http://docs.racket-lang.org/gui/frame_.html" class="RktValLink" data-pltdoc="x">frame%</a></span> in a slide. This is
intended to embed an "interactive" element, but I used it to embed a
<span class="RktSym"><a href="http://docs.racket-lang.org/gui/canvas_.html" class="RktValLink" data-pltdoc="x">canvas%</a></span> which I could then dynamically update to draw things.</p><p>I could have spent longer and made a movie playing
<a href="http://docs.racket-lang.org/gui/index.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket/gui</span></a> widget, but for expediency, I preprocessed
the movie and turned it into a sequence of PNGs using <span class="stt">ffmpeg</span>.</p><h5>2<tt>&nbsp;</tt><a name="(part._.The_.Dialogue_.System)"></a>The Dialogue System</h5><p>The more interesting system was the dialogue. Here&rsquo;s a snippet of code
to give you an idea what it looks like:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">6slide</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">thought</span><span class="hspace">&nbsp;</span><span class="RktSym">dev1</span><span class="hspace">&nbsp;</span><span class="RktVal">"I want to write a program to simulate my experience in Narshe."</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">:emacs</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">"magitek.rkt"</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">:clear</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">thought</span><span class="hspace">&nbsp;</span><span class="RktSym">dev1</span><span class="hspace">&nbsp;</span><span class="RktVal">"Now I need to share my package..."</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">command</span><span class="hspace">&nbsp;</span><span class="RktVal">"scp magitek.rkt server:public-html/"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">email</span><span class="hspace">&nbsp;</span><span class="RktSym">dev1</span><span class="hspace">&nbsp;</span><span class="RktVal">"Please try my program at: http://terra.com/magitek.rkt"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">:clear</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">thought</span><span class="hspace">&nbsp;</span><span class="RktSym">dev1</span><span class="hspace">&nbsp;</span><span class="RktVal">"I should expand my simulation to include the treasure house."</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">:mkdir</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">"narshe"</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">:mv</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">"magitek.rkt"</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">"narshe"</span><span class="hspace">&nbsp;</span><span class="RktVal">"magitek.rkt"</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">:emacs</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">"narshe"</span><span class="hspace">&nbsp;</span><span class="RktVal">"lone-wolf.rkt"</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">command</span><span class="hspace">&nbsp;</span><span class="RktVal">"scp -r narshe server:public-html/"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">email</span><span class="hspace">&nbsp;</span><span class="RktSym">dev1</span><span class="hspace">&nbsp;</span><span class="RktVal">"Please try my program at: http://terra.com/narshe"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">:clear</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span></td></tr></table></blockquote><p>The functions <span class="RktSym">thought</span> and <span class="RktSym">email</span> create the text
boxes formatted for a thought and an email. The function
<span class="RktSym">command</span> creates a command interaction and the functions
<span class="RktSym">:emacs</span>, <span class="RktSym">:mkdir</span>, and <span class="RktSym">:mv</span> are just thin
wrappers around <span class="RktSym">command</span>. Finally, <span class="RktSym">:clear</span> clears the
terminal session. Every single one of these functions will generate a
different slide.</p><p>The way this works is that <span class="RktSym">6slide</span> is a little programming
language interpreter. The programming model is based on mutating a
text box, a list of commands, and a file-system.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define-struct.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._struct%29%29" class="RktStxLink" data-pltdoc="x">struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">6state</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">last-speech</span><span class="hspace">&nbsp;</span><span class="RktSym">commands</span><span class="hspace">&nbsp;</span><span class="RktSym">fs</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">init-s</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">6state</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28lib._racket%2Flist..rkt%29._empty%29%29" class="RktValLink" data-pltdoc="x">empty</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/hashtables.html#%28def._%28%28quote._~23~25kernel%29._hash%29%29" class="RktValLink" data-pltdoc="x">hash</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>And the commands in the language are values that are created by the
functions mentioned above:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define-struct.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._struct%29%29" class="RktStxLink" data-pltdoc="x">struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">*speech</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">char</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/pict/Basic_Pict_Constructors.html#%28def._%28%28lib._pict%2Fmain..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define-struct.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._struct%29%29" class="RktStxLink" data-pltdoc="x">struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">*command</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/pict/Basic_Pict_Constructors.html#%28def._%28%28lib._pict%2Fmain..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktSym">outputs</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define-struct.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._struct%29%29" class="RktStxLink" data-pltdoc="x">struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">command-clear</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define-struct.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._struct%29%29" class="RktStxLink" data-pltdoc="x">struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">fs-set</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>The interpreter is very straight-forward:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">6exec</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/match.html#%28form._%28%28lib._racket%2Fmatch..rkt%29._match-define%29%29" class="RktStxLink" data-pltdoc="x">match-define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">6state</span><span class="hspace">&nbsp;</span><span class="RktSym">ls</span><span class="hspace">&nbsp;</span><span class="RktSym">cs</span><span class="hspace">&nbsp;</span><span class="RktSym">fs</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/match.html#%28form._%28%28lib._racket%2Fmatch..rkt%29._match%29%29" class="RktStxLink" data-pltdoc="x">match</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">?</span><span class="hspace">&nbsp;</span><span class="RktSym">*speech?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/struct-copy.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._struct-copy%29%29" class="RktStxLink" data-pltdoc="x">struct-copy</a></span><span class="hspace">&nbsp;</span><span class="RktSym">6state</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">last-speech</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">?</span><span class="hspace">&nbsp;</span><span class="RktSym">*command?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/struct-copy.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._struct-copy%29%29" class="RktStxLink" data-pltdoc="x">struct-copy</a></span><span class="hspace">&nbsp;</span><span class="RktSym">6state</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">commands</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._cons%29%29" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">cs</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">command-clear</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/struct-copy.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._struct-copy%29%29" class="RktStxLink" data-pltdoc="x">struct-copy</a></span><span class="hspace">&nbsp;</span><span class="RktSym">6state</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">last-speech</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*speech</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*speech-char</span><span class="hspace">&nbsp;</span><span class="RktSym">ls</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/pict/Basic_Pict_Constructors.html#%28def._%28%28lib._pict%2Fmain..rkt%29._blank%29%29" class="RktValLink" data-pltdoc="x">blank</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">commands</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28lib._racket%2Flist..rkt%29._empty%29%29" class="RktValLink" data-pltdoc="x">empty</a></span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">fs-set</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/struct-copy.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._struct-copy%29%29" class="RktStxLink" data-pltdoc="x">struct-copy</a></span><span class="hspace">&nbsp;</span><span class="RktSym">6state</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">fs</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/hashtables.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._hash-set%2A%29%29" class="RktValLink" data-pltdoc="x">hash-set*</a></span><span class="hspace">&nbsp;</span><span class="RktSym">fs</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">?</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._list~3f%29%29" class="RktValLink" data-pltdoc="x">list?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">as</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2Ffold%29%29" class="RktStxLink" data-pltdoc="x">for/fold</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-list%29%29" class="RktValLink" data-pltdoc="x">in-list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">as</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">6exec</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>It just does one unexpected thing, which is that when a command is a
list, they are all executed to completion. This allows me to show
multiple command line additions at the same time near the end of the
talk where the details start getting looser. For instance, I use the
following to show the command associated with an email all at once:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">email</span><span class="hspace">&nbsp;</span><span class="RktSym">dev1</span><span class="hspace">&nbsp;</span><span class="RktVal">"I just updated my package! The new source is..."</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">command</span><span class="hspace">&nbsp;</span><span class="RktVal">"raco pkg update http://terra.com/narshe.zip"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Since <span class="RktSym">6exec</span> defines how to run one command, I just wrap them
all together calling <span class="RktSym">6render</span>, which renders the state of the
language as a slide, each time:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">6slide</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym">actions</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/for.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._for%2Ffold%29%29" class="RktStxLink" data-pltdoc="x">for/fold</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">init-s</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/sequences.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._in-list%29%29" class="RktValLink" data-pltdoc="x">in-list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">actions</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ns</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">6exec</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">6render</span><span class="hspace">&nbsp;</span><span class="RktSym">ns</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">ns</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/void.html#%28def._%28%28quote._~23~25kernel%29._void%29%29" class="RktValLink" data-pltdoc="x">void</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>The weirdest part of the system is the way it tracks what files have
been created or moved, etc throughout the presentation. I originally
intended to display the file-system some how, but couldn&rsquo;t figure out a
good way to do it.</p><p>Finally, the way that I generated the character portraits was quite
painful. I downloaded sprite sheets from
<a href="http://www.spriters-resource.com/snes/ff6/index.html">The
Spriters Resource</a>. Unfortunately, sheets on that site have no
metadata about where the sprites are inside and they are rarely
consistent for a given game, even when produced by the same ripper. It
makes it very inconvenient to use programmatically. So, I wrote a
little program that would open up the sprite sheet and display it as
zoomed in a possible and let you move around a cursor in a very exact
way to read off the coordinates.</p><p>Once I manually did that for all eighteen characters, I entered the
data in and wrote a little function (<span class="RktSym">char-portrait</span>) that
extracted the appropriate piece of the sheet and then magnified it
using a scaling algorithm that does not blur at all.</p><p>This was painful to do, but I found it a bit beautiful that I could
whip up a Racket GUI program in 57 lines of code that did something
very useful for me. Of course, it is based on my
<a href="2013-05-13-vi-post.html" data-pltdoc="x">Vi-like Graphics Editor</a>, so it was quite
easy to do after knowing how to do it already.</p><p>Altogether, it took me about ten times longer than the talk itself to
implement the talk.</p><p>But it was worth it.</p><h5>3<tt>&nbsp;</tt><a name="(part._.Yo__.It_s_almost_time_to_go_)"></a>Yo! It&rsquo;s almost time to go!</h5><p>But first let&rsquo;s remember what we did today!</p><p>If you want beautiful, unique, and consistent slides, then you should
use <a href="http://docs.racket-lang.org/slideshow/index.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">slideshow</span></a>, a domain-specific language for making
slides.</p><p>If you want to go above an beyond, then use a domain-specific
language for making a particular set of slides.</p><p><div id="disqus_thread"><script type="text/javascript">
var disqus_shortname = 'jaymccarthy';
var disqus_identifier = 'http://jeapostrophe.github.com/blog/2013/09/30/pkgtalk/';
var disqus_url = 'http://jeapostrophe.github.com/2013-09-30-pkgtalk-post.html';
var disqus_script = 'embed.js';
(function () {
var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());

</script><noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript></div></p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="2013-09-23-dpr-post.html" title="backward to &quot;2013-09-23: Defer, Panic, and Recover in Racket&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="archive.html" title="up to &quot;Archive&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="2013-10-07-fseek-post.html" title="forward to &quot;2013-10-07: Saving State with Dynamic Wind&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>